<!DOCTYPE HTML>
<html>
	<head>
		<title>Test</title>
		<script src="ob/prototype.js" type="text/javascript" charset="utf-8"></script>
		<script src="ob/ob.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" charset="utf-8">
			ob.load("ob.gui.Button");
			ob.load("ob.gui.Menu");
			//ob.load("ob.Debug");
			
			window.WeirdView=Class.create(OBView,{
				redraw:function(){
					this.ctx.fillStyle="black";
					this.ctx.fillRect(0,0,this.attr('width'),this.attr('height'));
					this.ctx.strokeStyle="blue";
					this.ctx.lineWidth=50;
					this.ctx.strokeRect(0,0,this.attr('width'),this.attr('height'));
				}//,
				//mouseover:function(){console.info("mouseover");},
				//mouseout:function(){console.info("mouseout");}
			});
			window.Clicker=Class.create(OBView,{
				setup:function(){
					this.points=[];
				},
				redraw:function(){
					this.ctx.strokeStyle=OBColor.Yellow.toString();
					this.ctx.strokeRect(0,0,this.attr('width'),this.attr('height'));
					this.ctx.fillStyle=this.color;
					this.points.each(function(point){
						this.ctx.fillRect(point.attr('x'),point.attr("y"),5,5);
					},this);
				},
				color:"green",
				mousedown:function(evt){
					this.points.push(evt.point);
					this.update();
				},
				mousedrag:function(evt){
					this.mousedown(evt);
				},
				mousewheel:function(evt){
					console.info(evt);
				},
				dblclick:function(evt){
					alert(evt.point);
				}//,
				//mouseover:function(){console.info("mouseover");},
				//mouseout:function(){console.info("mouseout");}
			});
			function testAnim(){
				var a=new OBViewAnimation(window.z);
				a.attr("x",50);
				a.attr("y",50);
				a.attr("width",500);
				a.attr("opacity",0.5);
				a.attr("rotation",(45).toRadians());
				a.duration=3;
				a.observe("finished",function(){
					console.info("Finished Animation");
				});
				a.start();
			}
			document.observe("theme:loaded",function(){
				window.z=new WeirdView(null,new OBRect(10,10,300,300));
				window.click=new Clicker(window.z,new OBRect(10,10,200,200));
				window.b=new OBButton(null,new OBRect(500,500,0,0),"green");
				b.observe("click",function(){
					var m=new OBMenu([
						"green",
						"blue",
						"purple",
						"yellow",
						"white"
					]);
					m.observe("selected",function(x){
						b.attr("label",x);
						click.color=x;
						click.update();
						b.sizeToFit();
					});
					m.show(new OBRect(500,b.attr("y")-200,100,200));
				});
			});
		</script>
	</head>
	<body>
		<div style="text-align:center">
			LOADING...
		</div>
	</body>
</html>